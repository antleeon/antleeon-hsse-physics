# Симуляция отклика электрической цепи с использованием спектрального метода

## Описание проекта

Этот проект реализует симуляцию отклика электрической цепи на произвольный периодический входной электрический сигнал с использованием **спектрального метода**. Программа позволяет исследовать работу различных фильтров, таких как:
- **Фильтр низких частот (ФНЧ)**,
- **Фильтр высоких частот (ФВЧ)**,
- **Узкополосный фильтр**.

Также можно анализировать прохождение через цепь различных типов сигналов, включая:
- Гармонические сигналы,
- Последовательности импульсов,
- Цуги (волновые пакеты),
- Модулированные колебания,
- Широкополосные сигналы.

Проект состоит из модульной структуры, что упрощает добавление новых сигналов, фильтров и визуализаций.

---

## Структура проекта

```
m2-1b/
├── filters.py # Реализация фильтров (ФНЧ, ФВЧ, узкополосный)
├── main.py # Основной файл для запуска симуляций
├── signals.py # Генерация различных типов сигналов
├── utils.py # Вспомогательные функции (например, генерация временной сетки)
├── visualization.py # Визуализация сигналов и их спектров
├── requirements.txt # Зависимости, необходимые для работы проекта
└── README.md # Описание проекта
```

---

## Теоретическая справка

### Электрические цепи и фильтры

Электрические цепи состоят из различных компонентов, таких как резисторы, конденсаторы и катушки индуктивности, которые взаимодействуют с электрическими сигналами. Фильтры — это устройства или схемы, которые изменяют спектральный состав сигнала, пропуская определенные частоты и подавляя другие.

#### Типы фильтров
1. **Фильтр низких частот (ФНЧ)**:
   - Пропускает частоты ниже заданного порога (частоты среза) и подавляет высокие частоты.
   - Реализуется с помощью комбинации резисторов и конденсаторов (RC-цепь) или катушек индуктивности (RL-цепь).
   - Примерная передаточная функция:
     ![formula1][formula1],
     где ![fc][fc] — частота среза.

2. **Фильтр высоких частот (ФВЧ)**:
   - Пропускает частоты выше заданного порога и подавляет низкие частоты.
   - Реализуется с помощью RC- или RL-цепей, но с другой конфигурацией.
   - Примерная передаточная функция:
     ![formula2][formula2].

3. **Узкополосный фильтр**:
   - Пропускает частоты в заданном диапазоне (полосе пропускания) и подавляет частоты за его пределами.
   - Реализуется с помощью RLC-цепей, где резистор, катушка индуктивности и конденсатор соединены в определенной конфигурации.
   - Примерная передаточная функция:
     ![formula3][formula3],
     где ![f0][f0] — центральная частота, а ![Q][Q] — добротность фильтра.

---

### Спектральный метод

Спектральный метод основан на преобразовании сигнала из временной области в частотную с использованием **быстрого преобразования Фурье (FFT)**. Это позволяет анализировать частотный состав сигнала и применять фильтры, изменяя спектр.

#### Преобразование Фурье
Формула прямого преобразования Фурье:
![formula4][formula4]

Формула обратного преобразования Фурье:
![formula5][formula5]

#### Быстрое преобразование Фурье (FFT)
FFT — это алгоритм, который эффективно вычисляет дискретное преобразование Фурье (DFT):
![formula6][formula6],
где ![N][N] — количество точек дискретизации, а ![k][k] — индекс частоты.

---

### Типы сигналов

1. **Гармонический сигнал**:
   - Представляет собой синусоидальную волну:
     ![formula7][formula7],
     где ![A][A] — амплитуда, ![f][f] — частота, а ![phi][phi] — фаза.
   - Используется для моделирования простых периодических процессов.

2. **Последовательность импульсов**:
   - Сигнал, состоящий из чередующихся активных и неактивных состояний.
   - Используется для моделирования цифровых сигналов или импульсных процессов.

3. **Модулированный сигнал**:
   - Сигнал, амплитуда которого изменяется по закону другой функции:
     ![formula8][formula8],
     где ![At][At] — огибающая, а ![fc][fc] — несущая частота.
   - Пример: амплитудная модуляция (AM).

4. **Цуг (волновой пакет)**:
   - Сигнал с ограниченной длительностью, сосредоточенный вокруг определенной частоты:
     ![formula9][formula9],
     где ![f0][f0] — центральная частота, а ![alpha][alpha] — параметр ширины пакета.

5. **Широкополосный сигнал**:
   - Сумма нескольких гармонических сигналов с разными частотами:
     ![formula10][formula10],
     где ![fi][fi] — частоты, а ![Ai][Ai] — амплитуды.

---

### Реальные применения

1. **Фильтры в радиотехнике**:
   - Используются для выделения полезного сигнала из шума.
   - Пример: ФНЧ для подавления высокочастотных помех.

2. **Анализ спектра в электронике**:
   - Преобразование Фурье позволяет анализировать частотный состав сигналов.
   - Пример: анализ гармоник в аудиосигналах.

3. **Модуляция и демодуляция сигналов**:
   - Модулированные сигналы используются в радиосвязи для передачи информации.
   - Пример: AM и FM радиовещание.

4. **Импульсные сигналы в цифровой технике**:
   - Последовательности импульсов используются для передачи данных в цифровых системах.
   - Пример: сигналы в Ethernet или Wi-Fi.

5. **Цуги в физике**:
   - Волновые пакеты используются для моделирования локализованных волн.
   - Пример: моделирование квантовых частиц в квантовой механике.

---

## Инструкции по настройке и запуску

### Требования
- Python 3.10 или выше
- Установленные библиотеки:
  - `numpy`
  - `matplotlib`

### Установка
1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/antleeon/antleeon-hsse-physics.git
   cd m2-1b
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

### Запуск симуляции
Для запуска симуляции выполните:
   ```bash
   python main.py
   ```

### Настройка параметров
Вы можете настроить параметры симуляции, изменив вызовы функции `simulate_response` в файле `main.py`. Например:

- Измените параметры сигнала:
  ```py
  signal_kwargs={
    'freq': 100  # Частота сигнала, Гц
  }
  ```

- Измените параметры фильтра:
  ```py
  filter_kwargs={
    'cutoff': 80,  # Частота среза, Гц
    'transition_width': 10  # Ширина переходной области, Гц
  }
  ```

### Добавление новых сигналов или фильтров
1. Для добавления нового типа сигнала:
   - Реализуйте функцию в `signals.py`.
   - Убедитесь, что функция принимает массив времени `t` и возвращает массив значений сигнала.
2. Для добавления нового фильтра:
   - Реализуйте функцию в `filters.py`.
   - Убедитесь, что функция принимает массив частот `freqs` и спектр `spectrum`.

---

## Пример использования

### Пример 1: ФНЧ и гармонический сигнал
  - **Сигнал**: Гармонический сигнал с частотой 50 Гц.
  - **Фильтр**: ФНЧ с частотой среза 60 Гц и шириной переходной области 10 Гц.

### Пример 2: ФВЧ и последовательность импульсов
  - **Сигнал**: Последовательность импульсов с частотой 50 Гц.
  - **Фильтр**: ФВЧ с частотой среза 40 Гц и шириной переходной области 10 Гц.

### Пример 3: Узкополосный фильтр и модулированный сигнал
  - **Сигнал**: Модулированный сигнал с несущей частотой 50 Гц и частотой модуляции 5 Гц.
  - **Фильтр**: Узкополосный фильтр с диапазоном 40–60 Гц и шириной переходной области 10 Гц.

### Пример 4: ФНЧ и цуг (волновой пакет)
  - **Сигнал**: Цуг с центральной частотой 70 Гц и шириной пакета 50.
  - **Фильтр**: ФНЧ с частотой среза 60 Гц и шириной переходной области 15 Гц.

### Пример 5: ФВЧ и гармонический сигнал
  - **Сигнал**: Гармонический сигнал с частотой 30 Гц.
  - **Фильтр**: ФВЧ с частотой среза 40 Гц и шириной переходной области 5 Гц.

### Пример 6: ФНЧ и широкополосный сигнал
- **Сигнал**: Широкополосный сигнал с частотами 10, 30, 50, 70, 90 Гц.
- **Фильтр**: ФНЧ с частотой среза 40 Гц и шириной переходной области 10 Гц.

### Пример 7: ФВЧ и широкополосный сигнал
- **Сигнал**: Широкополосный сигнал с частотами 10, 30, 50, 70, 90 Гц.
- **Фильтр**: ФВЧ с частотой среза 60 Гц и шириной переходной области 10 Гц.

### Пример 8: Узкополосный фильтр и широкополосный сигнал
- **Сигнал**: Широкополосный сигнал с частотами 10, 30, 50, 70, 90 Гц.
- **Фильтр**: Узкополосный фильтр с диапазоном 40–70 Гц и шириной переходной области 10 Гц.

---

## Визуализация

Программа строит графики:
1. Входного сигнала во временной области.
2. Спектра входного сигнала.
3. Отфильтрованного сигнала во временной области.
4. Спектра отфильтрованного сигнала.

Внизу графиков отображается текстовое описание параметров симуляции.

---

## Авторы

Связаться с автором: [@antleeon](https://t.me/antleeon)

Проект разработан для учебных целей в рамках курса по моделированию физических процессов ВШПИ МФТИ.

---

## Ссылки на формулы

[formula1]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;H(f)=\frac{1}{1&plus;j\frac{f}{f_c}}
[formula2]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;H(f)=\frac{j\frac{f}{f_c}}{1&plus;j\frac{f}{f_c}}
[formula3]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;H(f)=\frac{1}{1&plus;jQ\left(\frac{f}{f_0}-\frac{f_0}{f}\right)}
[formula4]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;F(f)=\int_{-\infty}^{\infty}x(t)e^{-2\pi%20i%20f%20t}dt
[formula5]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;x(t)=\int_{-\infty}^{\infty}F(f)e^{2\pi%20i%20f%20t}df
[formula6]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;X[k]=\sum_{n=0}^{N-1}x[n]e^{-j\frac{2\pi}{N}kn}
[formula7]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;x(t)=A\sin(2\pi%20f%20t&plus;\phi)
[formula8]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;x(t)=A(t)\sin(2\pi%20f_c%20t)
[formula9]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;x(t)=e^{-\alpha(t-t_0)^2}\sin(2\pi%20f_0%20t)
[formula10]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;x(t)=\sum_{i=1}^N%20A_i\sin(2\pi%20f_i%20t)

[fc]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;f_c
[f0]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;f_0
[Q]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;Q
[N]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;N
[k]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;k
[A]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;A
[f]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;f
[phi]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;\phi
[At]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;A(t)
[alpha]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;\alpha
[fi]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;f_i
[Ai]: https://latex.codecogs.com/png.image?\bg{white}\dpi{200}&space;A_i